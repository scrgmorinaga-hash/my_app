import streamlit as st

# --- ã‚¿ã‚¤ãƒˆãƒ« ---
st.title('è‚©é–¢ç¯€ ROMè©•ä¾¡ã‚¢ãƒ—ãƒª Ver.2.3 ğŸ“')
st.markdown('**æœ€æ–°ã®é‹å‹•å­¦çŸ¥è¦‹ã«åŸºã¥ã„ãŸãƒªãƒãƒ“ãƒªé€²æ—ãƒã‚§ãƒƒã‚¯**')

# --- 1. æ¸¬å®šé …ç›®ã®è¨­å®š ---
st.header('1. å‹•ãã®è¨­å®š')
# 2ndå†…å¤–æ—‹ã‚’é™¤å¤–ã—ãŸãƒªã‚¹ãƒˆ
motion = st.selectbox(
    'æ¸¬å®šã™ã‚‹å‹•ãã‚’é¸ã‚“ã§ãã ã•ã„',
    ['å±ˆæ›² (Flexion)', 'ä¼¸å±• (Extension)', 'å¤–è»¢ (Abduction)', "1stå¤–æ—‹", "1stå†…æ—‹"]
)

# åŸºæº–å€¤ã®è¨­å®š
standards = {
    'å±ˆæ›² (Flexion)': 180, 
    'ä¼¸å±• (Extension)': 50, 
    'å¤–è»¢ (Abduction)': 180,
    '1stå¤–æ—‹': 60, 
    '1stå†…æ—‹': 80
}
standard = standards.get(motion)

st.info(f'ã€{motion}ã€‘ã®æ¨™æº–å€¤ã¯ **{standard}åº¦** ã§ã™ã€‚')

# --- 2. æ¸¬å®šå€¤ã®å…¥åŠ› ---
st.header('2. æ¸¬å®šå€¤ã®å…¥åŠ›')
col1, col2 = st.columns(2)
with col1:
    angle_r = st.number_input('å³ã®è§’åº¦ï¼ˆÂ°ï¼‰', min_value=0, max_value=180, value=0, key='right')
with col2:
    angle_l = st.number_input('å·¦ã®è§’åº¦ï¼ˆÂ°ï¼‰', min_value=0, max_value=180, value=0, key='left')

# --- 3. åˆ¤å®šã¨å¯è¦–åŒ– ---
st.header('3. è©•ä¾¡çµæœ')

if st.button('åˆ¤å®šã™ã‚‹'):
    min_angle = min(angle_r, angle_l)
    progress = min(min_angle / standard, 1.0)

    st.write(f'ç¾åœ¨ã®é”æˆç‡: **{int(progress * 100)}%**')
    st.progress(progress)

    diff = abs(angle_r - angle_l)
    if diff <= 5:
        st.success(f'å·¦å³å·®ã¯ {diff}åº¦ ã§ã™ã€‚è‰¯å¥½ãªãƒãƒ©ãƒ³ã‚¹ã§ã™ã€‚')
    else:
        st.warning(f'å·¦å³å·®ãŒ {diff}åº¦ ã‚ã‚Šã¾ã™ã€‚')

    # --- 4. é‹å‹•å­¦çš„åˆ†æã¨ã‚¢ãƒ‰ãƒã‚¤ã‚¹ï¼ˆæŒ‡å®šã®æ–°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼‰ ---
    st.divider()
    st.subheader('ğŸ’¡ é‹å‹•å­¦çš„åˆ†æã¨ã‚¢ãƒ‰ãƒã‚¤ã‚¹')

    # å°‚é–€æ›¸ã«åŸºã¥ã„ãŸãƒ‡ãƒ¼ã‚¿æ•´ç†
    analysis_data = {
        'å±ˆæ›² (Flexion)': {
            'agonists': 'ä¸‰è§’ç­‹å‰éƒ¨ã€å¤§èƒ¸ç­‹é–éª¨éƒ¨ã€çƒå£è…•ç­‹ã€ä¸Šè…•äºŒé ­ç­‹é•·é ­ã€æ£˜ä¸Šç­‹ã€æ£˜ä¸‹ç­‹',
            'antagonists': 'ä¸‰è§’ç­‹å¾Œéƒ¨ã€åºƒèƒŒç­‹ã€å¤§å††ç­‹ã€ä¸Šè…•ä¸‰é ­ç­‹é•·é ­'
        },
        'ä¼¸å±• (Extension)': {
            'agonists': 'ä¸‰è§’ç­‹å¾Œéƒ¨ã€åºƒèƒŒç­‹ã€å¤§å††ç­‹ã€ä¸Šè…•ä¸‰é ­ç­‹é•·é ­',
            'antagonists': 'ä¸‰è§’ç­‹å‰éƒ¨ã€å¤§èƒ¸ç­‹é–éª¨éƒ¨ã€çƒå£è…•ç­‹ã€ä¸Šè…•äºŒé ­ç­‹é•·é ­'
        },
        'å¤–è»¢ (Abduction)': {
            'agonists': 'ä¸‰è§’ç­‹ä¸­éƒ¨ã€æ£˜ä¸Šç­‹ã€ä¸Šè…•äºŒé ­ç­‹é•·é ­',
            'antagonists': 'å¤§èƒ¸ç­‹ã€åºƒèƒŒç­‹ã€å¤§å††ç­‹ã€çƒå£è…•ç­‹ã€è‚©ç”²ä¸‹ç­‹'
        },
        '1stå¤–æ—‹': {
            'agonists': 'æ£˜ä¸‹ç­‹ã€å°å††ç­‹ã€ä¸‰è§’ç­‹å¾Œéƒ¨',
            'antagonists': 'è‚©ç”²ä¸‹ç­‹ã€å¤§å††ç­‹ã€ä¸‰è§’ç­‹å‰éƒ¨ã€å¤§èƒ¸ç­‹ã€åºƒèƒŒç­‹ã€çƒå£è…•ç­‹'
        },
        '1stå†…æ—‹': {
            'agonists': 'è‚©ç”²ä¸‹ç­‹ã€å¤§å††ç­‹ã€ä¸‰è§’ç­‹å‰éƒ¨ã€å¤§èƒ¸ç­‹ã€åºƒèƒŒç­‹ã€çƒå£è…•ç­‹',
            'antagonists': 'æ£˜ä¸‹ç­‹ã€å°å††ç­‹ã€ä¸‰è§’ç­‹å¾Œéƒ¨'
        }
    }

    if motion in analysis_data:
        data = analysis_data[motion]

        st.markdown("**â–  ä¸»å‹•ä½œç­‹ã®ç­‹åŠ›ä½ä¸‹**")
        st.write(data['agonists'])

        st.markdown("**â–  æ‹®æŠ—ã™ã‚‹çµ„ç¹”ã«ã‚ˆã‚‹åˆ¶é™ã™ã‚‹å¯èƒ½æ€§**")
        st.write(data['antagonists'])

        st.markdown("**â–  å‡ºå…¸**")
        st.caption("ãƒ»åŸºç¤é‹å‹•å­¦ ç¬¬7ç‰ˆï¼ˆ2025å¹´ã€åŒ»æ­¯è–¬å‡ºç‰ˆï¼‰")
        st.caption("ãƒ»èº«ä½“é‹å‹•å­¦ é–¢ç¯€ã®åˆ¶å¾¡æ©Ÿæ§‹ã¨ç­‹æ©Ÿèƒ½ï¼ˆ2017å¹´ã€ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«ãƒ“ãƒ¥ãƒ¼ç¤¾ï¼‰")